# Tool Call Benchmark

> [!NOTE]
> This is a work in progress.

## Description

This tool call benchmark evaluates a model on 3 values:
1. **Tool Selection Accuracy** (0 to 1 higher is better)  
How many times does the model select the correct tool?
2. **Argument Hallucination Rate** (0 to 1 lower is better):  
How many times does the model hallucinate arguments?
3. **Trajectory Precision** (0 to 1 higher is better):  
How close is the model's execution to gold standard?

## Formulas

### 1. Tool Selection Accuracy (TSA)
This measures **Recall**: The percentage of expected tools that the agent successfully identified.

$$
\text{TSA} = \frac{| T_{agent} \cap T_{gold} |}{| T_{gold} |}
$$

* **Where:**
    * $T_{agent}$ is the set of unique tool names generated by the agent.
    * $T_{gold}$ is the set of unique tool names in the Gold Standard.
    * $| \cdot |$ denotes the count (cardinality) of the set.
    * $\cap$ denotes the intersection (tools present in both).

---

### 2. Argument Hallucination Rate (AHR)
This measures **Schema Violation**: The percentage of arguments that are incorrect or invented. This is calculated **only** for tools where the Agent's tool name matches the Gold Standard.

$$
\text{AHR} = \frac{ \sum_{t \in M} (A_{invalid}) }{ \sum_{t \in M} (A_{total}) }
$$

* **Where:**
    * $M$ is the set of matched tools (where `Agent_Tool_Name == Gold_Tool_Name`).
    * $A_{total}$ is the total count of arguments generated by the agent for tool $t$.
    * $A_{invalid}$ is the count of arguments for tool $t$ that are either:
        1.  **Hallucinated Keys:** Parameter names not present in the function definition.
        2.  **Incorrect Values:** Values that differ from the Gold Standard (or fail validation).

---

### 3. Trajectory Precision (TP)
This measures **Sequential Accuracy**: The edit distance required to transform the agent's path into the correct path. This uses the **Levenshtein Similarity** method we discussed.

$$
\text{TP} = 1 - \frac{ \text{lev}(P_{agent}, P_{gold}) }{ \max(|P_{agent}|, |P_{gold}|) }
$$

* **Where:**
    * $P_{agent}$ is the ordered list of tool names generated by the agent.
    * $P_{gold}$ is the ordered list of tool names in the Gold Standard.
    * $|P|$ denotes the length of the list (number of steps).
    * $\text{lev}(a, b)$ is the Levenshtein Distance (minimum number of insertions, deletions, or substitutions to change $a$ to $b$).
    * *Note: If the max length is 0 (both empty), the score is 1.0.*
